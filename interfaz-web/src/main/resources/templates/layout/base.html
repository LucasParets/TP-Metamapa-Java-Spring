<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
    <head>
        <meta charset="UTF-8">
        <title th:text="${titulo} + ' - MetaMapa'"></title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="/css/metamapa/metamapa.css">
        <link rel="stylesheet" href="/css/metamapa/metamapa_inicio.css">
        <link rel="stylesheet" href="/css/metamapa/colecciones.css">
        <link rel="stylesheet" href="/css/metamapa/sidebar.css">
        <link rel="stylesheet" href="/css/metamapa/login.css">
        <link rel="stylesheet" href="/css/metamapa/registrarse.css">
        <link rel="stylesheet" href="/css/metamapa/mis-hechos.css">
        <link rel="stylesheet" href="/css/admin/pagination.css"/>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/carousel/carousel.css"/>

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

        <meta name="_csrf" th:content="${_csrf.token}"/>
        <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    </head>
    <body>
        <nav class="metamapa-header">
            <div class="logo">MetaMapa</div>
            <div class="nav-buttons" sec:authorize="isAnonymous()">
                <a class="btn-login" th:href="@{/login}">Iniciar sesión</a>
                <a class="btn-registro" th:href="@{/registrarse}">Registrarme</a>
            </div>
            <div class="user-info-container" sec:authorize="isAuthenticated()">
                <img class="user-avatar" src="/img/avatar.webp" alt="Avatar">
                <span class="user-nombre" th:text="${#authentication.name.substring(0,1).toUpperCase() + #authentication.name.substring(1)}"></span>
            </div>
        </nav>
        <aside class="sidebar-container">
            <div class="sidebar-menu-container" id="sidebar-menu-container">
                <a th:href="@{/inicio}">Inicio</a>
                <a th:href="@{/colecciones}">Colecciones</a>
                <a th:href="@{/metamapa/colecciones}">Colecciones externas</a>
                <a th:href="@{/hechos/crear}">Crear hecho</a>
                <a sec:authorize="hasRole('USER')" th:href="@{/mis-hechos}">Mis hechos</a>
                <a sec:authorize="hasRole('ADMIN')" th:href="@{/admin}">Administrador</a>
                <form sec:authorize="isAuthenticated()" th:action="@{/logout}" method="post">
                    <button class="logout-btn" th:href="@{/logout}">Cerrar sesión</button>
                </form>
            </div>
            <div class="sidebar-btn-container" id="sidebar-btn-container">
                <span class="sidebar-btn" onclick="openCloseSidebar()">☰</span>
            </div>
        </aside>
        <div th:replace="~{${contenido} :: contenido}"></div>
        <th:block th:replace="~{fragments/alerta :: swal}"></th:block>
        <script th:src="@{/js/sidebar.js}"></script>
    </body>
</html>